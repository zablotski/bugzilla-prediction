var bz = require("bz");

var bugzilla = bz.createClient({
  username: '333onk@gmail.com',
  password: 'MMSe2014!',
  timeout: 30000
});

var data = ['1058759','1058183','1067141','1020156','1073692','1087120','1082970','334050','515196','989326','530209','979041','990799','1053939','1058412','1063698','1065525','1068660','1070138','1082130','1059376','1100463','1063669','1064281','1058140','1096921','1065122','920141','964819','1045715','1053434','1060945','1088789','1091656','1093766','1093790','1093875','1094509','1094782','1094830','1096371','1096430','1096469','1096542','1097408','1098431','1074081','1083632','1054959','1057186','1068284','1072320','1078213','1074976','1066101','1080911','992679','875766','1058237','1061947','1063594','1071821','1073497','1080784','1081071','1093368','1099952','918634','1059036','1052074','1072632','1073691','1081689','956482','1068290','1071238','1072036','1085330','1019762','1081547','1081548','1081549','1081551','1062522','1070223','1072118','1075658','1077738','1090456','1093161','1062683','1071088','1075620','1088729','714675','1095036','1060986','1063020','1067514','1079331','1090340','1093507','1061147','1069966','1082652','1075226','1092879','1092880','1036409','1040653','1076857','1077376','1077523','1097454','1065880','1069640','1071203','1076314','1060315','1063957','1071626','1072743','1074202','1100385','1062490','717824','1064885','1066588','1087356','1091901','1092808','1094409','1036693','1093074','1065977','892110','1035536','1057166','1060464','1060493','1062096','1066394','1069757','1070888','1073240','1074498','1080787','1082002','1090609','1093997','1094138','1094179','1094429','1096763','1097543','777674','1079185','1049551','1081203','620565','1065358','1059557','1071964','1065251','1055011','1057958','1062204','1074880','1088247','1093349','1094965','1097107','1082133','1095723','1098640','1071709','1074299','975084','979536','1009604','1055279','1061695','1062604','1062611','1064743','1065679','1069552','1070430','1070957','1071586','1073522','1073588','1078797','1084509','1089913','1091586','1094968','1097181','1055211','1055215','1057042','1058879','1059930','1066450','1066472','1068270','1068273','1068372','1069673','1069674','1074158','1077441','1077442','1077447','1078539','1083881','1050774','1088568','1099339','1039500','1059920','1098556','1046672','1067954','1067956','1070503','1070690','1066558','1069980','1075189','1084419','1058797','1081772','1091260','1095234','1097587','1098482','731865','1065785','1067164','1070096','1085622','1085694','1095527','1068949','857628','1073212','1050080','1053969','1058433','1058442','1063702','1063710','1063714','1063845','1065355','1069033','1069162','1070835','1070839','1072141','1072173','1073359','1079073','1079563','1091320','1095231','1074896','864250','947914','973641','987185','1058573','1064280','1087303','1014332','1053973','1054792','1075000','1095457','1031033','1089774','1086492','1092163','1080302','1033153','1045882','1067491','1068144','1068171','1070107','1074899','1076830','1076887','1087054','1090594','1095216','1096739','963089','994750','1000714','1005333','1083637','1099273','983259','1018796','1022579','1062969','1066218','1089812','1094296','1097236','1035707','1055571','1059727','1072208','1078235','1063105','1065446','1088704','1024110','1049248','1063926','1067827','1072181','1079835','1080690','1086936','1090324','1091605','1094505','1095420','1095511','1095934','1027817','1045647','1050384','1056923','1062745','1062748','1063206','1063648','1067319','1081093','1091036','1093883','985597','1008584','1020038','1050376','1059360','1063463','1064848','1067953','1094884','1096575','1088257','988237','1045660','1053805','1055666','1061673','1067380','1067424','1083045','1085628','1091706','1092451','1094203','1029471','1062127','1096010','1097542','1070149','1070863','1058405','1084158','1092160','1068381','1003713','1061714','1070202','1075444','1075665','1060885','1067287','1077857','1092452','1047738','1088578','1048687','1050944','1064910','1077282','1091109','1075672','1054492','1072798','1058435','1073238','1077200','1081343','960959','1020831','1047472','1060840','1067128','1067648','1070620','1071104','1071635','1071638','1072198','1072814','1073175','1073993','1078085','1087112','1088092','1095717','1096013','1099490','1099857','1050000','1050501','1070089','1072932','1082990','1084902','1089643','1091463','1096329','1062014','1051847','1064262','1067337','1074205','1077438','1085407','1091596','1091603','1091612','1093870','1096537','1052466','1047751','1059207','1067576','1069059','1070516','1072467','1072472','1072477','1072607','1085710','1091953','1091959','1092444','1031298','1090529','1061888','1064306','1075088','1077198','1078455','1080406','1076926','967201','916804','989168','1006394','1060046','757133','1053456','982484','698371','942707','921916','917696','859133','1064496','913711','1056342','1061653','1061772','1072164','923971','1028983','949754','684096','915426','1049825','916777','1060093','795917','1061759','407821','758857','1064282','1060888']; 

for (var i = 0+100+100+100+100; i < 100+100+100+100+100; ++i) {
  var item = data[i]; 
  bugzilla.getBug(parseInt(item), function(error, bug) {
    insertIntoDB(bug);
    if (!error) {
    }
  });  
}

function insertIntoDB(bug){

  var mysql      = require('mysql');
  var connection = mysql.createConnection({
    host     : 'localhost',
    user     : 'root',
    password : 'root'
  });

  connection.connect();

  var post  = {
    creation_time: bug.creation_time, 
    summary: bug.summary, 
    last_change_time: bug.last_change_time, 
    platform: bug.platform,
    op_sys: bug.op_sys,
    priority: bug.priority,
    depends: bug.depends_on.length,
    blocks: bug.blocks.length,
    resolution: bug.resolution, 
    classification: bug.classification, 
    component: bug.component
  };
  //console.log(post);
  var query = connection.query('INSERT INTO `bugzilla`.`bug` SET ?', post, function(err, result) {
    if(!err){
        console.log(result)
    }
    else{
        console.log(err);
    }
});

  connection.end();  
}
